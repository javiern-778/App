import{r as C,c as i,a as e,b as m,d as u,v as f,n as p,t as n,f as $,o as l,g as h,h as y,i as R,l as F,F as V,k as L,_ as S,j as U,m as E}from"./index-CujMdd7K.js";const M={class:"card p-4 shadow-sm rounded mt-3",style:{"max-width":"500px",margin:"auto"}},N={class:"mb-3"},B={key:0,class:"invalid-feedback"},P={class:"mb-3"},j={key:0,class:"invalid-feedback"},D={class:"mb-3"},T={key:0,class:"invalid-feedback"},A={class:"mb-3"},O={key:0,class:"invalid-feedback"},q={class:"mb-3"},z={key:0,class:"invalid-feedback"},G={class:"mb-3"},I={key:0,class:"invalid-feedback"},H={class:"mb-3"},J={key:0,class:"invalid-feedback"},K={class:"mb-4"},w={__name:"RegistroUsuarioForm",setup(k){const r=C({nombreCompleto:"",correo:"",matricula:"",contrasena:"",telefono:"",carrera:"",semestre:"",fotoPerfil:null}),o=C({nombreCompleto:"",correo:"",matricula:"",contrasena:"",telefono:"",carrera:"",semestre:""});function b(s){const t=s.target.files[0];if(!t)return;const a=new FileReader;a.onload=()=>{r.fotoPerfil=a.result.split(",")[1]},a.readAsDataURL(t)}function v(){Object.keys(o).forEach(t=>o[t]="");let s=!0;return r.nombreCompleto.trim()||(o.nombreCompleto="El nombre completo es obligatorio.",s=!1),r.correo.trim()?/\S+@\S+\.\S+/.test(r.correo)||(o.correo="Ingrese un correo válido.",s=!1):(o.correo="El correo es obligatorio.",s=!1),r.matricula.trim()||(o.matricula="La matrícula es obligatoria.",s=!1),r.contrasena.trim()||(o.contrasena="La contraseña es obligatoria.",s=!1),r.telefono.trim()||(o.telefono="El teléfono es obligatorio.",s=!1),r.carrera.trim()||(o.carrera="La carrera es obligatoria.",s=!1),(r.semestre===null||r.semestre===""||r.semestre<1||r.semestre>20)&&(o.semestre="El semestre debe estar entre 1 y 20.",s=!1),s}async function g(){if(v())try{await h.post("/usuarios",r),alert("Usuario registrado"),Object.keys(r).forEach(s=>r[s]=s==="fotoPerfil"?null:"")}catch(s){console.error("Error al registrar usuario:",s),alert("Error al registrar usuario")}}return(s,t)=>(l(),i("div",M,[t[9]||(t[9]=e("h4",{class:"mb-4"},"Registrar Usuario",-1)),e("form",{onSubmit:$(g,["prevent"]),novalidate:""},[e("div",N,[m(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>r.nombreCompleto=a),type:"text",class:p(["form-control",{"is-invalid":o.nombreCompleto}]),placeholder:"Nombre Completo"},null,2),[[f,r.nombreCompleto]]),o.nombreCompleto?(l(),i("div",B,n(o.nombreCompleto),1)):u("",!0)]),e("div",P,[m(e("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>r.correo=a),type:"email",class:p(["form-control",{"is-invalid":o.correo}]),placeholder:"Correo"},null,2),[[f,r.correo]]),o.correo?(l(),i("div",j,n(o.correo),1)):u("",!0)]),e("div",D,[m(e("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>r.matricula=a),type:"text",class:p(["form-control",{"is-invalid":o.matricula}]),placeholder:"Matrícula"},null,2),[[f,r.matricula]]),o.matricula?(l(),i("div",T,n(o.matricula),1)):u("",!0)]),e("div",A,[m(e("input",{"onUpdate:modelValue":t[3]||(t[3]=a=>r.contrasena=a),type:"password",class:p(["form-control",{"is-invalid":o.contrasena}]),placeholder:"Contraseña"},null,2),[[f,r.contrasena]]),o.contrasena?(l(),i("div",O,n(o.contrasena),1)):u("",!0)]),e("div",q,[m(e("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>r.telefono=a),type:"tel",class:p(["form-control",{"is-invalid":o.telefono}]),placeholder:"Teléfono"},null,2),[[f,r.telefono]]),o.telefono?(l(),i("div",z,n(o.telefono),1)):u("",!0)]),e("div",G,[m(e("input",{"onUpdate:modelValue":t[5]||(t[5]=a=>r.carrera=a),type:"text",class:p(["form-control",{"is-invalid":o.carrera}]),placeholder:"Carrera"},null,2),[[f,r.carrera]]),o.carrera?(l(),i("div",I,n(o.carrera),1)):u("",!0)]),e("div",H,[m(e("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>r.semestre=a),type:"number",min:"1",max:"20",class:p(["form-control",{"is-invalid":o.semestre}]),placeholder:"Semestre"},null,2),[[f,r.semestre,void 0,{number:!0}]]),o.semestre?(l(),i("div",J,n(o.semestre),1)):u("",!0)]),e("div",K,[t[7]||(t[7]=e("label",{class:"form-label"},"Foto de Perfil",-1)),e("input",{type:"file",onChange:b,class:"form-control"},null,32)]),t[8]||(t[8]=e("button",{type:"submit",class:"btn btn-primary w-100"},"Guardar",-1))],32)]))}},Q={class:"container mt-4"},W={class:"table table-bordered table-striped"},X=["onClick"],Y=["onClick"],Z={__name:"RegistroUsuarioList",setup(k){const r=y([]),o=y(!1),b=y(null),v=async()=>{try{const d=await h.get("/usuarios");r.value=d.data}catch(d){console.error("Error al cargar usuarios:",d)}},g=d=>{b.value={...d},o.value=!0},s=async d=>{if(confirm("¿Estás seguro de que deseas eliminar este usuario?"))try{await h.delete(`/usuarios/${d}`),await v()}catch(_){console.error("Error al eliminar usuario:",_)}},t=()=>{o.value=!1,b.value=null},a=()=>{v(),t()};return R(v),(d,_)=>(l(),i("div",Q,[_[1]||(_[1]=e("h4",{class:"mb-3"},"Lista de Usuarios",-1)),o.value?(l(),F(w,{key:0,usuarioEdit:b.value,onFormEnviado:a,onCancelarEdicion:t},null,8,["usuarioEdit"])):u("",!0),e("table",W,[_[0]||(_[0]=e("thead",null,[e("tr",null,[e("th",null,"Nombre"),e("th",null,"Correo"),e("th",null,"Matrícula"),e("th",null,"Teléfono"),e("th",null,"Carrera"),e("th",null,"Semestre"),e("th",null,"Acciones")])],-1)),e("tbody",null,[(l(!0),i(V,null,L(r.value,c=>(l(),i("tr",{key:c.id},[e("td",null,n(c.nombreCompleto),1),e("td",null,n(c.correo),1),e("td",null,n(c.matricula),1),e("td",null,n(c.telefono),1),e("td",null,n(c.carrera),1),e("td",null,n(c.semestre),1),e("td",null,[e("button",{class:"btn btn-sm btn-warning me-2",onClick:x=>g(c)},"Editar",8,X),e("button",{class:"btn btn-sm btn-danger",onClick:x=>s(c.id)},"Eliminar",8,Y)])]))),128))])])]))}},ee={components:{RegistroUsuarioForm:w,RegistroUsuarioList:Z}};function oe(k,r,o,b,v,g){const s=E("RegistroUsuarioForm"),t=E("RegistroUsuarioList");return l(),i("div",null,[U(s),U(t)])}const te=S(ee,[["render",oe]]);export{te as default};
